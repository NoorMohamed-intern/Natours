{"mappings":"mGAEO,MAAMA,EAAS,KACpB,MAAMC,EAAKC,SAASC,cAAc,UAC9BF,GAAIA,EAAGG,cAAcC,YAAYJ,IAI1BK,EAAS,CAAIC,EAAMC,KAC9BR,IACA,MAAMS,EAAM,4BAA+BF,MAASC,UACpDN,SAASC,cAAc,QAAQO,mBAAmB,aAAcD,GAChEE,OAAOC,WAAWZ,EAAW,MCPlBa,EAAcC,MAAUC,EAAMR,KACzC,IACE,MAAMS,EACK,aAATT,EACI,iCACA,yBAQkB,mBANNU,EAAAC,EAAA,CAAM,CACtBC,OAAQ,YACRH,OACAD,KAGMA,KAAKK,QACXd,EAAU,UAAS,GAAKC,EAAKc,uCAE/B,MAAOC,GACPhB,EAAU,QAASgB,EAAIC,SAASR,KAAKS,WCfnCC,EAAYvB,SAASC,cAAc,gBACnCuB,EAAYxB,SAASC,cAAc,oBACnCwB,EAAezB,SAASC,cAAc,mBACtCyB,EAAmB1B,SAASC,cAAc,uBAC1C0B,EAAU3B,SAAS4B,eAAe,aAEpCL,GACFA,EAAUM,iBAAiB,UAAWC,IACpCA,EAAEC,iBCVYnB,OAAUoB,EAAOC,KAGjC,IAU0B,mBATNlB,EAAAC,EAAA,CAAM,CACtBC,OAAQ,OACRH,IAAK,sBACLD,KAAM,OACJmB,WACAC,MAIIpB,KAAKK,SACXd,EAAU,UAAW,0BACrBK,OAAOC,YAAU,KACfwB,SAASC,OAAO,OACf,OAEL,MAAOC,GACPhC,EAAU,QAASgC,EAAMf,SAASR,KAAKS,WDPvCe,CAFcrC,SAAS4B,eAAe,SAASU,MAC9BtC,SAAS4B,eAAe,YAAYU,UAKrDd,GAAWA,EAAUK,iBAAiB,SCOvBjB,UACjB,IAK0B,mBAJNG,EAAAC,EAAA,CAAM,CACtBC,OAAQ,MACRH,IAAK,0BAECD,KAAKK,QAAsBgB,SAASK,QAAO,GACnD,MAAOnB,GACPoB,QAAQC,IAAIrB,EAAIC,UAChBjB,EAAU,QAAS,4CDdnBqB,GACFA,EAAaI,iBAAiB,UAAWC,IACvCA,EAAEC,iBACF,MAAMW,EAAO,IAAIC,SACjBD,EAAKE,OAAO,OAAQ5C,SAAS4B,eAAe,QAAQU,OACpDI,EAAKE,OAAO,QAAS5C,SAAS4B,eAAe,SAASU,OACtDI,EAAKE,OAAO,QAAS5C,SAAS4B,eAAe,SAASiB,MAAM,IAE5DlC,EAAe+B,EAAM,WAGrBhB,GACFA,EAAiBG,iBAAiB,UAAQjB,MAASkB,IACjDA,EAAEC,iBACF/B,SAASC,cAAc,uBAAuB6C,YAAc,cAE5D,MAAMC,EAAkB/C,SAAS4B,eAAe,oBAAoBU,MAC9DL,EAAWjC,SAAS4B,eAAe,YAAYU,MAC/CU,EAAkBhD,SAAS4B,eAAe,oBAAoBU,YAE9D3B,EACJ,iBAAEoC,WAAiBd,kBAAUe,GAC7B,YAGFhD,SAASC,cAAc,uBAAuB6C,YAAc,gBAC5D9C,SAAS4B,eAAe,oBAAoBU,MAAQ,GACpDtC,SAAS4B,eAAe,YAAYU,MAAQ,GAC5CtC,SAAS4B,eAAe,oBAAoBU,MAAQ,MAGpDX,GACFA,EAAQE,iBAAiB,SAAUC,IACjCA,EAAEmB,OAAOH,YAAc,gBACvB,MAAOI,OAACA,GAAWpB,EAAEmB,OAAOE,QEvDXvC,OAAUsC,IAC7B,MAAME,EAASC,OACb,+GAEF,IAEE,MAAMC,QAAgBvC,EAAAC,EAAA,CAAK,qCAAsCkC,WAI3DE,EAAOG,mBAAmB,CAC9BC,UAAWF,EAAQzC,KAAKyC,QAAQG,KAElC,MAAOrC,GACPoB,QAAQC,IAAIrB,GACZhB,EAAU,QAASgB,KFyCnBsC,CAASR","sources":["public/js/alerts.js","public/js/updateSettings.js","public/js/index.js","public/js/login.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\r\n\r\nexport const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n// type is 'success' or 'error'\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\n// type is either 'password' or 'data'\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? '/api/v1/users/updateMyPassword'\r\n        : '/api/v1/users/updateMe';\r\n\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data,\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n","import '@babel/polyfill';\r\nimport { login, logout } from './login';\r\nimport { updateSettings } from './updateSettings';\r\nimport { bookTour } from './stripe';\r\n\r\n//DOM ELEMENTS\r\n\r\nconst loginForm = document.querySelector('.form--login');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\nconst bookBtn = document.getElementById('book-tour');\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\r\n\r\nif (userDataForm)\r\n  userDataForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', document.getElementById('photo').files[0]);\r\n\r\n    updateSettings(form, 'data');\r\n  });\r\n\r\nif (userPasswordForm)\r\n  userPasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n\r\n    const passwordCurrent = document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n\r\n    await updateSettings(\r\n      { passwordCurrent, password, passwordConfirm },\r\n      'password'\r\n    );\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'Save password';\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n\r\nif (bookBtn)\r\n  bookBtn.addEventListener('click', (e) => {\r\n    e.target.textContent = 'Processing...';\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n  });\r\n","/* eslint-disable */\r\n\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  // console.log(email, password);\r\n\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '/api/v1/users/logout',\r\n    });\r\n    if (res.data.status === 'success') location.reload(true);\r\n  } catch (err) {\r\n    console.log(err.response);\r\n    showAlert('error', 'Error logging in try again later sry');\r\n  }\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const bookTour = async (tourId) => {\r\n  const stripe = Stripe(\r\n    'pk_test_51KrF4OSBx1fAtecdsMMCTOAkCN5tvOZVHeWZ3Y6ycjXfvRRZVpJsRKO0qXdh9nt3INkQU4pZvLPh1eYxBThZkKLA00NHbql4cD'\r\n  );\r\n  try {\r\n    // 1. Get checkout session from the API\r\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\r\n    // console.log(session);\r\n\r\n    // 2. Create checkout form + charge credit card\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch (err) {\r\n    console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};\r\n"],"names":["$243742c2ddd61256$export$516836c6a9dfc573","el","document","querySelector","parentElement","removeChild","$243742c2ddd61256$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$ef4652913d3a37c8$export$f558026a994b6051","async","data","url","$parcel$interopDefault","$hxiRl$axios","method","status","toUpperCase","err","response","message","$a89f9b8d1da9e7c9$var$loginForm","$a89f9b8d1da9e7c9$var$logOutBtn","$a89f9b8d1da9e7c9$var$userDataForm","$a89f9b8d1da9e7c9$var$userPasswordForm","$a89f9b8d1da9e7c9$var$bookBtn","getElementById","addEventListener","e","preventDefault","email","password","location","assign","error","$ffb5fef29ccd135c$export$596d806903d1f59e","value","reload","console","log","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","target","tourId","dataset","stripe","Stripe","session","redirectToCheckout","sessionId","id","$f30796ec7fbab015$export$8d5bdbf26681c0c2"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}